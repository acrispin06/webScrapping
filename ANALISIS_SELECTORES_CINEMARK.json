{
  "analisis_cinemark": {
    "timestamp": "2025-10-29 12:12:06",
    "url": "https://www.cinemark-peru.com/pelicula/good-boy-temporada-siniestra",
    "pelicula_analizada": "Good Boy: Temporada Siniestra",
    "archivos_generados": [
      "NAVEGACION_MANUAL_RESULTADO.json",
      "cinemark_pelicula_NAVEGACION.html",
      "cinemark_homepage.html"
    ]
  },
  "hallazgos_principales": {
    "pagina_actual": "Página de detalle de película",
    "estructura": "React SPA con Material-UI",
    "datos_cargados_dinamicamente": true,
    "apis_capturadas": "NINGUNA - No se detectaron llamadas API en los logs",
    "formato_detectado": "2D",
    "fecha_estreno": "23 Octubre, 2025",
    "duracion": "1h 12m",
    "cine_ejemplo": "Cinemark Asia",
    "direccion_cine": "Boulevard de Asia. Km 97.5 de la Panamericana Sur"
  },
  "selectores_identificados": {
    "navegacion_principal": {
      "boton_cartelera": {
        "selector": "button.MuiButton-root.MuiButton-iconText:contains('Cartelera')",
        "alternativa": "button.MuiButton-iconText.mui-10jgp21:contains('Cartelera')",
        "tipo": "Material-UI Button"
      },
      "boton_elegir_cine": {
        "selector": "button.MuiButton-root.MuiButton-iconText:contains('Cinemark Asia')",
        "texto_ejemplo": "Cinemark Asia",
        "tiene_dropdown": true,
        "icono_dropdown": "svg path (fill='currentColor')",
        "descripcion": "Botón con nombre del cine + icono de dropdown"
      },
      "boton_elegir_pelicula": {
        "selector": "button.MuiButton-root.MuiButton-iconText:contains('Elegir Película')",
        "clase_principal": "mui-1gsczbx",
        "alternativas": ["mui-1tz0d2t"],
        "tiene_dropdown": true
      },
      "boton_perfil_usuario": {
        "selector": "button[data-testid='header_user_profile']",
        "data_testid": "header_user_profile",
        "clase": "MuiButton-icon MuiButton-iconPrimary mui-1alfoug",
        "descripcion": "Botón para iniciar sesión o acceder al perfil"
      }
    },
    "detalles_pelicula": {
      "formato_disponible": {
        "selector": "div.mui-134z699 h2:contains('Formatos disponibles') + p",
        "ejemplo_texto": "2D",
        "valores_posibles": ["2D", "3D", "XD", "IMAX", "4DX"],
        "descripcion": "Indica la modalidad de proyección"
      },
      "duracion": {
        "selector": "div.mui-134z699 h2:contains('Duración') + p",
        "ejemplo_texto": "1h 12m"
      },
      "fecha_estreno": {
        "selector": "div.mui-134z699 h2:contains('Fecha de estreno') + p",
        "ejemplo_texto": "23 Octubre, 2025"
      },
      "distribuidor": {
        "selector": "div.mui-134z699 h2:contains('Distribuidor') + p",
        "ejemplo_texto": "CINEPLEX S.A."
      }
    },
    "seccion_horarios": {
      "titulo_horarios": {
        "selector": "h2.MuiTypography-h1:contains('Horarios')",
        "clase": "mui-129h4q2"
      },
      "filtros_sesiones": {
        "contenedor": "section[data-testid='session-filters']",
        "data_testid": "session-filters",
        "boton_formatos": {
          "selector": "button.MuiButtonGroup-grouped:contains('Formatos')",
          "clase": "mui-1so3b8z",
          "tiene_dropdown": true,
          "descripcion": "Filtro para seleccionar formato (2D, 3D, etc)"
        }
      },
      "contenedor_sesiones": {
        "selector": "div[data-testid='sessions']",
        "data_testid": "sessions",
        "descripcion": "Contiene todas las sesiones/horarios disponibles"
      },
      "informacion_cine": {
        "nombre_cine": {
          "selector": "span.MuiTypography-h2.mui-hdz6a5",
          "ejemplo_texto": "Cinemark Asia",
          "contexto": "Dentro de 'Horarios en [nombre_cine]'"
        },
        "direccion": {
          "selector": "span.MuiTypography-body1.mui-1mi1pab",
          "ejemplo_texto": "Boulevard de Asia. Km 97.5 de la Panamericana Sur"
        },
        "mensaje_sin_sesiones": {
          "selector": "p.mui-17h4bc",
          "texto": "En este cine no tenemos funciones que cumplan con tu criterio de búsqueda...",
          "indicador": "NO HAY HORARIOS DISPONIBLES con los filtros actuales"
        }
      },
      "leyenda_ocupacion": {
        "disponible": {
          "selector": "svg + p:contains('Disponible')",
          "clase_texto": "mui-193fbxk"
        },
        "poco_disponible": {
          "selector": "svg + p:contains('Poco Disponible')"
        },
        "lleno": {
          "selector": "svg + p:contains('Lleno')"
        }
      }
    },
    "botones_compra": {
      "comprar_entradas_principal": {
        "selector": "button[data-testid='buy-tickets-button']",
        "data_testid": "buy-tickets-button",
        "texto": "Comprar entradas",
        "estado_deshabilitado": "Mui-disabled",
        "descripcion": "Deshabilitado hasta que se seleccione un horario"
      },
      "comprar_entradas_flotante": {
        "selector": "button.MuiButton-fixed.mui-b080ps",
        "clase": "MuiButton-fixed MuiButton-fixedPrimary",
        "texto": "Comprar entradas",
        "descripcion": "Botón flotante que aparece al hacer scroll"
      },
      "ver_horarios_mas_cines": {
        "selector": "button.mui-1delbwl:contains('Ver horarios en más cines')",
        "texto": "Ver horarios en más cines"
      }
    },
    "tabs_navegacion": {
      "tab_horarios": {
        "selector": "button[role='tab']:contains('Horarios')",
        "aria_selected": "true (cuando activo)",
        "clase_activa": "Mui-selected"
      },
      "tab_sobre": {
        "selector": "button[role='tab']:contains('Sobre')",
        "descripcion": "Tab para ver más información de la película"
      }
    }
  },
  "flujo_navegacion_detectado": {
    "paso_1": "Homepage → Click en película o botón Cartelera",
    "paso_2": "Página de película → Se muestra información básica (formato, duración, etc)",
    "paso_3": "Seleccionar cine → Usar dropdown 'Cinemark Asia' o botón 'Ver horarios en más cines'",
    "paso_4": "Filtrar sesiones → Usar filtros de formato, fecha, etc (section[data-testid='session-filters'])",
    "paso_5": "Seleccionar horario → Click en botón de horario específico (NO VISIBLE EN HTML ACTUAL)",
    "paso_6": "Comprar entradas → Click en button[data-testid='buy-tickets-button']",
    "nota_critica": "NO SE DETECTARON HORARIOS EN EL HTML - Posiblemente se cargan dinámicamente al cambiar filtros o cine"
  },
  "problemas_detectados": {
    "problema_1": {
      "descripcion": "NO HAY HORARIOS VISIBLES EN EL HTML CAPTURADO",
      "evidencia": "Mensaje: 'En este cine no tenemos funciones que cumplan con tu criterio de búsqueda'",
      "causa_probable": [
        "La película no tiene funciones en Cinemark Asia para la fecha actual",
        "Los filtros por defecto no coinciden con funciones disponibles",
        "Necesita interacción para cargar horarios (cambiar fecha, formato, etc)"
      ],
      "impacto": "CRÍTICO - No podemos extraer estructura de botones de horario ni precios",
      "solucion_propuesta": [
        "1. Navegar manualmente cambiando filtros de fecha hasta encontrar horarios",
        "2. O cambiar a otro cine que SÍ tenga funciones",
        "3. O seleccionar otra película con más horarios disponibles"
      ]
    },
    "problema_2": {
      "descripcion": "NO SE CAPTURARON APIs EN LOS LOGS",
      "evidencia": "apis_capturadas: [] en NAVEGACION_MANUAL_RESULTADO.json",
      "causa_probable": [
        "Las APIs usan diferentes palabras clave (no contienen 'api', 'cinema', 'movie', etc)",
        "Datos embebidos en HTML inicial (Server-Side Rendering de Next.js)",
        "APIs cargadas antes de iniciar la captura de logs"
      ],
      "impacto": "ALTO - No podemos usar APIs directamente, necesitamos Selenium",
      "solucion_propuesta": "Usar Selenium con esperas dinámicas para cargar elementos"
    },
    "problema_3": {
      "descripcion": "CLASES CSS DINÁMICAS DE MATERIAL-UI",
      "evidencia": "Clases como 'mui-10jgp21', 'mui-1gsczbx' son generadas dinámicamente",
      "impacto": "MEDIO - Los selectores pueden cambiar entre versiones",
      "solucion_propuesta": [
        "Priorizar data-testid cuando esté disponible",
        "Usar selectores basados en texto visible (:contains)",
        "Combinar selectores: tipo de elemento + clase MUI base + texto"
      ]
    }
  },
  "siguientes_pasos_recomendados": {
    "paso_1": {
      "accion": "EJECUTAR NUEVO NAVEGADOR MANUAL",
      "objetivo": "Capturar HTML con horarios visibles",
      "instrucciones": [
        "Navegar a película con más funciones (ej: película de estreno)",
        "O cambiar de cine en el dropdown hasta encontrar uno con horarios",
        "O cambiar la fecha en los filtros",
        "Esperar a que aparezcan botones de horario",
        "Capturar HTML en ese momento"
      ]
    },
    "paso_2": {
      "accion": "ANALIZAR ESTRUCTURA DE BOTONES DE HORARIO",
      "objetivo": "Identificar selectores para:",
      "datos_a_extraer": [
        "Hora del horario (ej: 14:30, 17:00)",
        "Formato/Sala (2D, 3D, XD, etc)",
        "Estado (Disponible, Poco Disponible, Lleno)",
        "Precio (si está visible sin login)"
      ]
    },
    "paso_3": {
      "accion": "INVESTIGAR FLUJO DE PRECIOS",
      "objetivo": "Determinar si necesitamos login para ver precios",
      "instrucciones": [
        "Click en horario específico",
        "Verificar si muestra precios inmediatamente",
        "O si redirige a login primero",
        "Capturar selectores de página de precios"
      ]
    },
    "paso_4": {
      "accion": "DISEÑAR ESTRATEGIA DE SCRAPING",
      "objetivo": "Crear main_cinemark_v1.py basado en hallazgos",
      "componentes": [
        "configurar_driver() - Setup de Selenium con esperas",
        "navegar_a_pelicula(url) - Ir a página de película",
        "seleccionar_cine(nombre_cine) - Click en dropdown y seleccionar",
        "esperar_horarios_cargados() - Esperar data-testid='sessions'",
        "extraer_horarios() - Parsear botones de horario",
        "extraer_precios_por_horario() - Click y obtener precios",
        "guardar_csv() - Formato igual que Cineplanet"
      ]
    }
  },
  "selectores_prioritarios_para_scraping": {
    "nivel_critico": [
      "button[data-testid='header_user_profile'] - Login",
      "section[data-testid='session-filters'] - Filtros",
      "div[data-testid='sessions'] - Contenedor horarios",
      "button[data-testid='buy-tickets-button'] - Compra"
    ],
    "nivel_alto": [
      "button:contains('Elegir Película') - Selector de película",
      "button:contains('Cinemark Asia') - Selector de cine",
      "span.mui-hdz6a5 - Nombre del cine",
      "span.mui-1mi1pab - Dirección del cine",
      "div.mui-134z699 h2 + p - Detalles película (formato, duración, etc)"
    ],
    "nivel_medio": [
      "button[role='tab']:contains('Horarios') - Tab horarios",
      "p.mui-17h4bc - Mensaje sin sesiones",
      "button.mui-1delbwl - Ver más cines"
    ]
  },
  "comparacion_con_cineplanet": {
    "cineplanet": {
      "tecnologia": "HTML tradicional",
      "selectores": "Estables (clases fijas)",
      "apis": "No expuestas",
      "navegacion": "Linear (página por página)",
      "login_requerido": "Sí para precios"
    },
    "cinemark": {
      "tecnologia": "React SPA + Next.js",
      "selectores": "Dinámicos (Material-UI auto-generados)",
      "apis": "Posiblemente ocultas/SSR",
      "navegacion": "Dinámica (filtros en misma página)",
      "login_requerido": "A CONFIRMAR"
    },
    "estrategia_adaptacion": {
      "similitudes_aprovechables": [
        "Mismo formato CSV de salida",
        "Mismo flujo: seleccionar cine → película → horario → precios",
        "Login puede ser similar (usuario/contraseña)"
      ],
      "diferencias_a_manejar": [
        "Usar data-testid en lugar de clases fijas",
        "Esperas dinámicas más largas (React tarda en cargar)",
        "Filtros interactivos en lugar de páginas separadas",
        "Posible necesidad de scroll para cargar horarios (lazy loading)"
      ]
    }
  },
  "configuracion_selenium_recomendada": {
    "esperas": {
      "implicita": "10 segundos (React es más lento)",
      "explicita": "WebDriverWait hasta 20 segundos",
      "condiciones": [
        "presence_of_element_located(('css selector', '[data-testid=sessions]'))",
        "element_to_be_clickable(('css selector', 'button[data-testid=buy-tickets-button]'))",
        "text_to_be_present_in_element(('css selector', 'span.mui-hdz6a5'), 'Cinemark')"
      ]
    },
    "opciones_chrome": [
      "--disable-blink-features=AutomationControlled",
      "--disable-dev-shm-usage",
      "--no-sandbox",
      "user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"
    ],
    "headless": "Mejor empezar con headless=False para debug, luego activar"
  }
}
